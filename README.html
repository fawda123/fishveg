<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>README</title>

<script src="README_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="README_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="README_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="README_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="README_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="README_files/navigation-1.1/tabsets.js"></script>
<link href="README_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="README_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">README</h1>

</div>


<div id="files" class="section level4">
<h4>Files</h4>
<p>All data created in <code>R\dat_proc.R</code>. Source data in the ignore folder were created elsewhere.</p>
<ul>
<li><p><code>country.RData</code> SpatialPolygonsDataFrame of US conterminous state borders</p></li>
<li><p><code>fish_dat.RData</code> Same as <code>fish_all.RData</code> but data are converted to CPUE, surveys are Jul/Aug/Sep, and ‘standard population assessments’ and ‘resurveys’. CPUE is estimated as total fish weight (kg) divided by effort, unique to species, date, lake, and gear type. CPUE was estimated separately for trapnet, gillnet. Length to weight equations were from the Handbook of Freshwater Fishery Biology. The arguments to <code>cpue_fun</code> show the species and gear type combos, including parameters for length/weight conversions. Bullhead are black and yellow bullhead combined, and crappie are white and black crappie combined. Species are not separated by adult or yoy.</p></li>
<li><p><code>fishveg_dat.RData</code> combined fisheries and veg data, veg data summarized by total rich and subm rich for each lake. Fish and veg data combined if the survey was in the same year. Covariates for each lake include UTM coordinates, ecoregion, watershed area, lake depth, lake area, percent human development in watershed, SDI, and secchi depth.</p></li>
<li><p><code>map_dat.RData</code> Several R objects for creating plots.</p></li>
<li><p><code>mnstate.RData</code> SpatialPolygonsDataFrame of MN state boundaries</p></li>
<li><p><code>veg_dat.RData</code> DNR veg transect data from 1992 to present. Format is dow, date, transect, species, and abundance category. NULL abundance entries are not removed, these are species in the survey but not observed on a transect. Note that there were no lakes in the dataset that had zero veg.</p></li>
</ul>
</div>
<div id="summary-table" class="section level4">
<h4>Summary table</h4>
<table>
<thead>
<tr class="header">
<th align="left">Ecoregion</th>
<th align="left">Variable</th>
<th align="left">Ave. (Med.)</th>
<th align="left">Var.</th>
<th align="left">Min./Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ETF</td>
<td align="left">SpeciesRichness</td>
<td align="left">10.3 (10)</td>
<td align="left">27.6</td>
<td align="left">0 / 24</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Carp</td>
<td align="left">2.1 (0.4)</td>
<td align="left">23</td>
<td align="left">0 / 45.1</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bullhead</td>
<td align="left">1.4 (0.1)</td>
<td align="left">42.6</td>
<td align="left">0 / 87.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Bluegill</td>
<td align="left">1.9 (1.1)</td>
<td align="left">6.7</td>
<td align="left">0 / 18</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Area</td>
<td align="left">2.5 (1.4)</td>
<td align="left">12.3</td>
<td align="left">0.1 / 22.5</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Depth</td>
<td align="left">11.2 (9.7)</td>
<td align="left">50.5</td>
<td align="left">1.8 / 34.2</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Human</td>
<td align="left">0.6 (0.6)</td>
<td align="left">0</td>
<td align="left">0.1 / 1</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">SDI</td>
<td align="left">1.7 (1.5)</td>
<td align="left">0.4</td>
<td align="left">1.1 / 4.4</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Secchi</td>
<td align="left">1.6 (1.4)</td>
<td align="left">0.7</td>
<td align="left">0.3 / 5.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">ShedArea</td>
<td align="left">112.5 (28.9)</td>
<td align="left">77601.3</td>
<td align="left">0.2 / 2808.1</td>
</tr>
<tr class="odd">
<td align="left">GP</td>
<td align="left">SpeciesRichness</td>
<td align="left">3.6 (3)</td>
<td align="left">13.6</td>
<td align="left">0 / 16</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Carp</td>
<td align="left">6.1 (3.7)</td>
<td align="left">47.8</td>
<td align="left">0 / 36</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Bullhead</td>
<td align="left">5.8 (1.9)</td>
<td align="left">95</td>
<td align="left">0 / 48.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Bluegill</td>
<td align="left">0.5 (0.1)</td>
<td align="left">1.8</td>
<td align="left">0 / 10.8</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Area</td>
<td align="left">2.3 (1.5)</td>
<td align="left">6.7</td>
<td align="left">0.2 / 10.9</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Depth</td>
<td align="left">4.7 (3.4)</td>
<td align="left">13.7</td>
<td align="left">1.5 / 25.3</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Human</td>
<td align="left">0.7 (0.8)</td>
<td align="left">0</td>
<td align="left">0.4 / 0.9</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">SDI</td>
<td align="left">1.7 (1.5)</td>
<td align="left">0.3</td>
<td align="left">1 / 3.5</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Secchi</td>
<td align="left">0.8 (0.6)</td>
<td align="left">0.4</td>
<td align="left">0.2 / 3.5</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">ShedArea</td>
<td align="left">34.1 (10.8)</td>
<td align="left">2134.9</td>
<td align="left">1.2 / 249.4</td>
</tr>
</tbody>
</table>
<pre><code>##  var      vif             
##  Carp     1.40087938822791
##  Bullhead 1.32609969244421
##  Bluegill 1.2967275170074 
##  Secchi   2.31599398230004
##  SDI      1.34263804704789
##  Human    1.22289758460126
##  Area     1.65132535880825
##  ShedArea 1.61081633407663
##  Depth    2.36527586392161
## 
## All variables have VIF &lt; 10, max VIF 2.37</code></pre>
<pre><code>## [1] &quot;Carp&quot;     &quot;Bullhead&quot; &quot;Bluegill&quot; &quot;Secchi&quot;   &quot;SDI&quot;      &quot;Human&quot;   
## [7] &quot;Area&quot;     &quot;ShedArea&quot; &quot;Depth&quot;</code></pre>
</div>
<div id="figures" class="section level4">
<h4>Figures</h4>
<p><img src="README_files/figure-html/Fig1.png" width="60%" style="display: block; margin: auto;" /></p>
<p><img src="README_files/figure-html/Fig2.png" width="60%" style="display: block; margin: auto;" /></p>
<p><img src="README_files/figure-html/Fig3.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="between-group-differences" class="section level4">
<h4>Between group differences</h4>
<pre class="r"><code>library(vegan)
library(tidyverse)
library(mvabund)

# prep data
merged_2 &lt;- read.csv(&quot;ignore/merged_2.csv&quot;)

d &lt;- merged_2[, c(
  &quot;S_rich&quot;, &quot;common.carp_GN&quot;, &quot;black.bullhead_TN&quot;, &quot;bluegill_TN&quot;,
  &quot;secchim&quot;, &quot;sdi&quot;, &quot;phuman&quot;, &quot;aream2&quot;, &quot;shedaream2&quot;, &quot;ecoreg&quot;, &quot;depthm&quot;
)]
names(d) &lt;- c(
  &quot;SpeciesRichness&quot;, &quot;Carp&quot;, &quot;Bullhead&quot;, &quot;Bluegill&quot;, &quot;Secchi&quot;, &quot;SI&quot;,
  &quot;Human&quot;, &quot;Area&quot;, &quot;ShedArea&quot;, &quot;Ecoregion&quot;, &quot;Depth&quot;
)
levels(d$Ecoregion) &lt;- c(&quot;Forest&quot;, &quot;Plain&quot;)

d &lt;- within(d, {
  Bullhead.cut &lt;- cut(Bullhead, c(-Inf, 0, 0.5, 1, 2, 5, 10, 20, Inf))
  Carp.cut &lt;- cut(Carp, c(-Inf, 0, 0.5, 1, 2, 5, 10, 20, Inf))
  Bullhead.plusMin &lt;- Bullhead + min(Bullhead[Bullhead &gt; 0])
  Carp.plusMin &lt;- Carp + min(Carp[Carp &gt; 0])
  Bluegill.plusMin &lt;- Bluegill + min(Bluegill[Bluegill &gt; 0])
})
d$AnyCarp &lt;- ifelse(d$Carp &gt; 1, &quot;C&quot;, &quot;NC&quot;) ## 1 is a value for Carp and bullhead when impact becomes visible
d$AnyBullhead &lt;- ifelse(d$Bullhead &gt; 1, &quot;B&quot;, &quot;NB&quot;)
d$Group &lt;- factor(paste0(d$AnyCarp, &quot;-&quot;, d$AnyBullhead))
d$Group &lt;- relevel(d$Group, &quot;NC-NB&quot;)
d1 &lt;- subset(d, ShedArea &lt; 100000000 &amp; Area &lt; 10000000)

# get distance matrix of fish abundance
abudist &lt;- d1 %&gt;% 
  select(Carp, Bullhead) %&gt;% 
  vegdist

# lake groups
grps &lt;- d1$Group

# exploratory plot
toplo &lt;- d1 %&gt;% 
  select(Carp, Bullhead, Group) %&gt;% 
  gather(&#39;spp&#39;, &#39;abu&#39;, -Group) %&gt;% 
  group_by(Group, spp) %&gt;% 
  summarise(
    ave = mean(abu, na.rm = T), 
    vrc = var(abu, na.rm = T)
  )

ggplot(toplo, aes(x = ave, y = vrc, colour = spp, shape = Group)) + 
  geom_point(size = 6) + 
  theme_bw() + 
  scale_x_log10(&#39;Log-mean abundance&#39;) + 
  scale_y_log10(&#39;Log-variance abundance&#39;)</code></pre>
<p><img src="README_files/figure-html/unnamed-chunk-3.png" width="60%" style="display: block; margin: auto;" /></p>
<pre class="r"><code># get multivariate homogeneity of groups
bdisper &lt;- betadisper(abudist, grps)

# test if one or more groups is more variable than the others
# variance between group is not homogenous
permutest(bdisper)</code></pre>
<pre><code>## 
## Permutation test for homogeneity of multivariate dispersions
## Permutation: free
## Number of permutations: 999
## 
## Response: Distances
##            Df Sum Sq Mean Sq      F N.Perm Pr(&gt;F)    
## Groups      3 2.0485 0.68283 36.375    999  0.001 ***
## Residuals 235 4.4114 0.01877                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># multivariate abundance
abund &lt;- d1 %&gt;% 
  select(Carp, Bullhead) %&gt;% 
  mvabund

# test for group (location) effecgt
mod &lt;- manyglm(abund ~ grps, family = &#39;negative.binomial&#39;)
anova(mod)</code></pre>
<pre><code>## Time elapsed: 0 hr 0 min 7 sec</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model: manyglm(formula = abund ~ grps, family = &quot;negative.binomial&quot;)
## 
## Multivariate test:
##             Res.Df Df.diff   Dev Pr(&gt;Dev)    
## (Intercept)    258                           
## grps           255       3 613.3    0.001 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Arguments:
##  Test statistics calculated assuming uncorrelated response (for faster computation) 
##  P-value calculated using 999 resampling iterations via PIT-trap resampling (to account for correlation in testing).</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
